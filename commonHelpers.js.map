{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst input = document.querySelector(\"input\");\nconst form = document.querySelector(\".form\");\nconst loadMoreButton = document.querySelector('.btn-load');\nconst galleryContainer = document.querySelector(\".gallery\");\nconst loadMoreBtn = document.querySelector('.btn-load');\n\nlet currentPage = 1;\nconst perPage = 15;\n\nconst config = {\n    apiKey: '42337135-3774c2f446ec3f71c1b4c916a',\n    baseUrl: 'https://pixabay.com/api/',\n};\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n    captions: true,\n    captionType: 'attr',\n    captionsData: 'alt',\n    captionPosition: 'bottom',\n    fadeSpeed: 150,\n    captionSelector: 'img',\n    captionDelay: 250,\n});\n\nconst showLoader = () => {\n    const loader = document.createElement('span');\n    loader.classList.add('loader');\n    document.body.append(loader);\n};\n\nconst hideLoader = () => {\n    const loader = document.querySelector('.loader');\n    if (loader) {\n        loader.remove();\n    }\n};\n\nfunction buildPixabayUrl(searchInput, page = 1) {\n    return `${config.baseUrl}?key=${config.apiKey}&q=${searchInput}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${perPage}`;\n}\nasync function fetchDataAndUpdateGallery() {\n    const searchInput = input.value.trim();\n    const url = buildPixabayUrl(searchInput, currentPage);\n\n    try {\n        const response = await axios.get(url);\n\n        if (!response || !response.data || response.data.hits.length === 0) {\n            iziToast.info({\n                title: 'Info',\n                message: 'No images found for the given search term.',\n                position: 'center',\n            });\n            // Clear previous markup\n            galleryContainer.innerHTML = '';\n            hideLoader();\n            return;\n        }\n\n        const data = response.data;\n        updateGallery(data);\n    } catch (error) {\n        console.error('Error fetching data:', error);\n        hideLoader();\n        // Clear previous markup\n        galleryContainer.innerHTML = '';\n\n        if (error.response) {\n            // The request was made and the server responded with a status code\n            // that falls out of the range of 2xx\n            iziToast.error({\n                title: 'Error',\n                message: `API Error: ${error.response.data.message}`,\n                position: 'center',\n            });\n        } else if (error.request) {\n            // The request was made but no response was received\n            iziToast.error({\n                title: 'Error',\n                message: 'Network Error. Please check your internet connection.',\n                position: 'center',\n            });\n        } else {\n            // Something happened in setting up the request that triggered an Error\n            iziToast.error({\n                title: 'Error',\n                message: 'An unexpected error occurred. Please try again later.',\n                position: 'center',\n            });\n        }\n    }\n\n}\n\nform.addEventListener('submit', async function (e) {\n    e.preventDefault();\n    currentPage = 1;\n    const searchInput = input.value.trim();\n\n    if (!searchInput) {\n        iziToast.error({\n            title: 'Error',\n            message: 'Please enter a valid search term',\n        });\n        return;\n    }\n\n    showLoader();\n    await fetchDataAndUpdateGallery();\n\n    e.target.reset();\n    hideLoader();\n});\n\nloadMoreButton.addEventListener('click', async function () {\n    currentPage++;\n    showLoader();\n    await fetchDataAndUpdateGallery();\n});\n\nfunction updateGallery(data) {\n\n\n    const galleryItem = document.querySelector('.gallery-item');\n\n    if (galleryItem) {\n        const cardHeight = galleryItem.getBoundingClientRect().height;\n        window.scrollBy(0, galleryContainer.clientHeight);\n    }\n\n    const markup = data.hits.map(data => `\n        <li class=\"gallery-item\">\n            <a href=\"${data.largeImageURL}\">\n                <img class=\"gallery-image\" src=\"${data.webformatURL}\" alt=\"${data.tags}\">\n            </a>\n            <p><b>Likes: </b>${data.likes}</p>\n            <p><b>Views: </b>${data.views}</p>\n            <p><b>Comments: </b>${data.comments}</p>\n            <p><b>Downloads: </b>${data.downloads}</p>\n        </li>`).join('');\n\n    galleryContainer.innerHTML += markup;\n    lightbox.refresh();\n\n    hideLoader();\n\n    const totalHits = data.totalHits || 0;\n\n    if (totalHits <= currentPage * perPage) {\n        loadMoreButton.style.display = 'none';\n        iziToast.info({\n            title: 'Info',\n            message: \"We're sorry, but you've reached the end of search results.\",\n            position: 'center',\n            transitionIn: 'fadeInLeft',\n        });\n    } else {\n        loadMoreButton.style.display = 'block';\n    }\n}\n"],"names":["input","form","loadMoreButton","galleryContainer","currentPage","perPage","config","lightbox","SimpleLightbox","showLoader","loader","hideLoader","buildPixabayUrl","searchInput","page","fetchDataAndUpdateGallery","url","response","axios","iziToast","data","updateGallery","error","e","galleryItem","markup"],"mappings":"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"}